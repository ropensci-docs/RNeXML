<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="RNeXML">
<title>A Brief Introduction to RNeXML â€¢ RNeXML</title>
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="A Brief Introduction to RNeXML">
<meta property="og:description" content="RNeXML">
<meta property="og:image" content="https://docs.ropensci.org/RNeXML/logo.svg">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
<!-- End Matomo Code -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">RNeXML</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.4.11</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/S4.html">The nexml S4 Object</a>
    <a class="dropdown-item" href="../articles/intro.html">A Brief Introduction to RNeXML</a>
    <a class="dropdown-item" href="../articles/metadata.html">Handling Metadata in RNeXML</a>
    <a class="dropdown-item" href="../articles/simmap.html">Extending NeXML: an example based on simmap</a>
    <a class="dropdown-item" href="../articles/sparql.html">SPARQL with RNeXML</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/RNeXML/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>A Brief Introduction to RNeXML</h1>
                        <h4 data-toc-skip class="author">Carl Boettiger</h4>
                        <h4 data-toc-skip class="author">Scott Chamberlain</h4>
                        <h4 data-toc-skip class="author">Rutger Vos</h4>
                        <h4 data-toc-skip class="author">Hilmar Lapp</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/RNeXML/blob/HEAD/vignettes/intro.Rmd" class="external-link"><code>vignettes/intro.Rmd</code></a></small>
      <div class="d-none name"><code>intro.Rmd</code></div>
    </div>

    
    
<!--
%\VignetteEngine{knitr::rmarkdown}
%\VignetteIndexEntry{A Brief Introduction to RNeXMLL}
-->
<p>Read in a <code>nexml</code> file:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples"</span>, <span class="st">"comp_analysis.xml"</span>, package<span class="op">=</span><span class="st">"RNeXML"</span><span class="op">)</span></span>
<span><span class="va">nexml</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nexml_read.html">nexml_read</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span></code></pre></div>
<p>Pretty-print an overview of the components and metadata that make up the nexml object:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nexml</span>  <span class="co"># this is the same as show(nexml)</span></span></code></pre></div>
<pre><code><span><span class="co">## A nexml object representing:</span></span>
<span><span class="co">##       1 phylogenetic tree block(s), where:</span></span>
<span><span class="co">##     block 1 contains 1 phylogenetic tree(s) </span></span>
<span><span class="co">##       2 character block(s), where:</span></span>
<span><span class="co">##     block 1 defines 1 continuous character(s) </span></span>
<span><span class="co">##     matrix 1 has 10 row(s)</span></span>
<span><span class="co">##     block 2 defines 1 standard/discrete character(s), with 2 states each </span></span>
<span><span class="co">##      and  0 polymorphic or uncertain state(s) defined </span></span>
<span><span class="co">##     matrix 2 has 10 row(s) </span></span>
<span><span class="co">##       10 taxonomic units in 1 block(s) </span></span>
<span><span class="co">##   Taxa:   taxon_1, taxon_2, taxon_3, taxon_4, taxon_5, taxon_6 ...</span></span>
<span><span class="co">##   Metadata annotations: </span></span>
<span><span class="co">##  2 at top level </span></span>
<span><span class="co">##  0 in block 1 at otu level </span></span>
<span><span class="co">##  0 in block 1 at char level</span></span>
<span><span class="co">##  0 in block 2 at char level </span></span>
<span><span class="co">##  0 in block 1 at state level</span></span>
<span><span class="co">##  0 in block 2 at state level</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Author(s): rvosa</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## NeXML generated by Bio::Phylo::Project v.0.56 using schema version: 0.9 </span></span>
<span><span class="co">## Size: 289.3 Kb</span></span></code></pre>
<p>Create a summary object of various component and metadata counts (the <code><a href="https://rdrr.io/r/methods/show.html" class="external-link">show()</a></code> method uses this):</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">nexml</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $nblocks</span></span>
<span><span class="co">##      trees       otus characters </span></span>
<span><span class="co">##          1          1          2 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $ncharacters</span></span>
<span><span class="co">## block.1 block.2 </span></span>
<span><span class="co">##       1       1 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $nstates</span></span>
<span><span class="co">##         block.1 block.2</span></span>
<span><span class="co">## Min.         NA       2</span></span>
<span><span class="co">## 1st Qu.      NA       2</span></span>
<span><span class="co">## Median       NA       2</span></span>
<span><span class="co">## Mean         NA       2</span></span>
<span><span class="co">## 3rd Qu.      NA       2</span></span>
<span><span class="co">## Max.         NA       2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $nnonstdstatedefs</span></span>
<span><span class="co">##         polymorphic uncertain</span></span>
<span><span class="co">## block.1          NA        NA</span></span>
<span><span class="co">## block.2           0         0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $nmatrixrows</span></span>
<span><span class="co">## block.1 block.2 </span></span>
<span><span class="co">##      10      10 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $ntrees</span></span>
<span><span class="co">## block.1 </span></span>
<span><span class="co">##       1 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $notus</span></span>
<span><span class="co">## block.1 </span></span>
<span><span class="co">##      10 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $nmeta</span></span>
<span><span class="co">## $nmeta$nexml</span></span>
<span><span class="co">## [1] 2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $nmeta$otu</span></span>
<span><span class="co">## block.1 </span></span>
<span><span class="co">##       0 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $nmeta$char</span></span>
<span><span class="co">## block.1 block.2 </span></span>
<span><span class="co">##       0       0 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $nmeta$state</span></span>
<span><span class="co">## block.1 block.2 </span></span>
<span><span class="co">##       0       0</span></span></code></pre>
<p>Extract trees from nexml into the <code><a href="https://rdrr.io/pkg/ape/man/read.tree.html" class="external-link">ape::phylo</a></code> format:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_trees.html">get_trees</a></span><span class="op">(</span><span class="va">nexml</span><span class="op">)</span> <span class="co"># or: as(nexml, "phylo")</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tr</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="intro-unnamed-chunk-5-1.png" alt=""><p class="caption">plot of chunk unnamed-chunk-5</p>
</div>
<p>Write an <code><a href="https://rdrr.io/pkg/ape/man/read.tree.html" class="external-link">ape::phylo</a></code> tree into the <code>nexml</code> format:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">bird.orders</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/nexml_write.html">nexml_write</a></span><span class="op">(</span><span class="va">bird.orders</span>, <span class="st">"test.xml"</span>, creator <span class="op">=</span> <span class="st">"Carl Boettiger"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "test.xml"</span></span></code></pre>
<p>A key feature of NeXML is the ability to formally validate the construction of the data file against the standard (the lack of such a feature in nexus files had lead to inconsistencies across different software platforms, and some files that cannot be read at all). While it is difficult to make an invalid NeXML file from <code>RNeXML</code>, it never hurts to validate just to be sure:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/nexml_validate.html">nexml_validate</a></span><span class="op">(</span><span class="st">"test.xml"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<p>Extract metadata from the NeXML file:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">birds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nexml_read.html">nexml_read</a></span><span class="op">(</span><span class="st">"test.xml"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/get_taxa.html">get_taxa</a></span><span class="op">(</span><span class="va">birds</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     otu            label xsi.type otus</span></span>
<span><span class="co">## 1  ou37 Struthioniformes       NA  os3</span></span>
<span><span class="co">## 2  ou38     Tinamiformes       NA  os3</span></span>
<span><span class="co">## 3  ou39      Craciformes       NA  os3</span></span>
<span><span class="co">## 4  ou40      Galliformes       NA  os3</span></span>
<span><span class="co">## 5  ou41     Anseriformes       NA  os3</span></span>
<span><span class="co">## 6  ou42    Turniciformes       NA  os3</span></span>
<span><span class="co">## 7  ou43       Piciformes       NA  os3</span></span>
<span><span class="co">## 8  ou44    Galbuliformes       NA  os3</span></span>
<span><span class="co">## 9  ou45   Bucerotiformes       NA  os3</span></span>
<span><span class="co">## 10 ou46      Upupiformes       NA  os3</span></span>
<span><span class="co">## 11 ou47    Trogoniformes       NA  os3</span></span>
<span><span class="co">## 12 ou48    Coraciiformes       NA  os3</span></span>
<span><span class="co">## 13 ou49      Coliiformes       NA  os3</span></span>
<span><span class="co">## 14 ou50     Cuculiformes       NA  os3</span></span>
<span><span class="co">## 15 ou51   Psittaciformes       NA  os3</span></span>
<span><span class="co">## 16 ou52      Apodiformes       NA  os3</span></span>
<span><span class="co">## 17 ou53   Trochiliformes       NA  os3</span></span>
<span><span class="co">## 18 ou54  Musophagiformes       NA  os3</span></span>
<span><span class="co">## 19 ou55     Strigiformes       NA  os3</span></span>
<span><span class="co">## 20 ou56    Columbiformes       NA  os3</span></span>
<span><span class="co">## 21 ou57       Gruiformes       NA  os3</span></span>
<span><span class="co">## 22 ou58    Ciconiiformes       NA  os3</span></span>
<span><span class="co">## 23 ou59    Passeriformes       NA  os3</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_metadata.html">get_metadata</a></span><span class="op">(</span><span class="va">birds</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">##           property   datatype                 content     xsi.type                                              href Meta</span></span>
<span><span class="co">## 1       dc:creator xsd:string          Carl Boettiger  LiteralMeta                                              &lt;NA&gt; m278</span></span>
<span><span class="co">## 2 dcterms:modified xsd:string 2020-01-28 23:24:19 GMT  LiteralMeta                                              &lt;NA&gt; m279</span></span>
<span><span class="co">## 3       cc:license       &lt;NA&gt;                    &lt;NA&gt; ResourceMeta http://creativecommons.org/publicdomain/zero/1.0/ m280</span></span></code></pre>
<hr>
<p>Add basic additional metadata:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="../reference/nexml_write.html">nexml_write</a></span><span class="op">(</span><span class="va">bird.orders</span>, file<span class="op">=</span><span class="st">"meta_example.xml"</span>,</span>
<span>              title <span class="op">=</span> <span class="st">"My test title"</span>,</span>
<span>              description <span class="op">=</span> <span class="st">"A description of my test"</span>,</span>
<span>              creator <span class="op">=</span> <span class="st">"Carl Boettiger &lt;cboettig@gmail.com&gt;"</span>,</span>
<span>              publisher <span class="op">=</span> <span class="st">"unpublished data"</span>,</span>
<span>              pubdate <span class="op">=</span> <span class="st">"2012-04-01"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "meta_example.xml"</span></span></code></pre>
<p>By default, <code>RNeXML</code> adds certain metadata, including the NCBI taxon id numbers for all named taxa. This acts a check on the spelling and definitions of the taxa as well as providing a link to additional metadata about each taxonomic unit described in the dataset.</p>
<div class="section level3">
<h3 id="advanced-annotation">Advanced annotation<a class="anchor" aria-label="anchor" href="#advanced-annotation"></a>
</h3>
<p>We can also add arbitrary metadata to a NeXML tree by define <code>meta</code> objects:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modified</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/meta.html">meta</a></span><span class="op">(</span>property <span class="op">=</span> <span class="st">"prism:modificationDate"</span>,</span>
<span>                 content <span class="op">=</span> <span class="st">"2013-10-04"</span><span class="op">)</span></span></code></pre></div>
<p>Advanced use requires specifying the namespace used. Metadata follows the RDFa conventions. Here we indicate the modification date using the prism vocabulary. This namespace is included by default, as it is used for some of the basic metadata shown in the previous example. We can see from this list:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">RNeXML</span><span class="fu">:::</span><span class="va">nexml_namespaces</span></span></code></pre></div>
<pre><code><span><span class="co">##                                              nex                                              xsi </span></span>
<span><span class="co">##                      "http://www.nexml.org/2009"      "http://www.w3.org/2001/XMLSchema-instance" </span></span>
<span><span class="co">##                                              xml                                             cdao </span></span>
<span><span class="co">##           "http://www.w3.org/XML/1998/namespace"                "http://purl.obolibrary.org/obo/" </span></span>
<span><span class="co">##                                              xsd                                               dc </span></span>
<span><span class="co">##              "http://www.w3.org/2001/XMLSchema#"               "http://purl.org/dc/elements/1.1/" </span></span>
<span><span class="co">##                                          dcterms                                            prism </span></span>
<span><span class="co">##                      "http://purl.org/dc/terms/" "http://prismstandard.org/namespaces/1.2/basic/" </span></span>
<span><span class="co">##                                               cc                                             ncbi </span></span>
<span><span class="co">##                 "http://creativecommons.org/ns#"          "http://www.ncbi.nlm.nih.gov/taxonomy#" </span></span>
<span><span class="co">##                                               tc </span></span>
<span><span class="co">##  "http://rs.tdwg.org/ontology/voc/TaxonConcept#"</span></span></code></pre>
<p>This next block defines a resource (link), described by the <code>rel</code> attribute as a homepage, a term in the <code>foaf</code> vocabulary. Because <code>foaf</code> is not a default namespace, we will have to provide its URL in the full definition below.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">website</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/meta.html">meta</a></span><span class="op">(</span>href <span class="op">=</span> <span class="st">"http://carlboettiger.info"</span>, </span>
<span>                rel <span class="op">=</span> <span class="st">"foaf:homepage"</span><span class="op">)</span></span></code></pre></div>
<p>Here we create a history node using the <code>skos</code> namespace. We can also add id values to any metadata element to make the element easier to reference externally:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">history</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/meta.html">meta</a></span><span class="op">(</span>property <span class="op">=</span> <span class="st">"skos:historyNote"</span>, </span>
<span>                  content <span class="op">=</span> <span class="st">"Mapped from the bird.orders data in the ape package using RNeXML"</span>,</span>
<span>                  id <span class="op">=</span> <span class="st">"meta123"</span><span class="op">)</span></span></code></pre></div>
<p>For this kind of richer annotation, it is best to build up our NeXML object sequentially. First we will add <code>bird.orders</code> phylogeny to a new phylogenetic object, and then we will add the metadata elements created above to this object. Finally, we will write the object out as an XML file:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">birds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_trees.html">add_trees</a></span><span class="op">(</span><span class="va">bird.orders</span><span class="op">)</span></span>
<span>  <span class="va">birds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_meta.html">add_meta</a></span><span class="op">(</span>meta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">history</span>, <span class="va">modified</span>, <span class="va">website</span><span class="op">)</span>,</span>
<span>                    namespaces <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>skos <span class="op">=</span> <span class="st">"http://www.w3.org/2004/02/skos/core#"</span>,</span>
<span>                                   foaf <span class="op">=</span> <span class="st">"http://xmlns.com/foaf/0.1/"</span><span class="op">)</span>,</span>
<span>                    nexml<span class="op">=</span><span class="va">birds</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/nexml_write.html">nexml_write</a></span><span class="op">(</span><span class="va">birds</span>, </span>
<span>              file <span class="op">=</span> <span class="st">"example.xml"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "example.xml"</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="taxonomic-identifiers">Taxonomic identifiers<a class="anchor" aria-label="anchor" href="#taxonomic-identifiers"></a>
</h3>
<p>Add taxonomic identifier metadata to the OTU elements: <!-- This block relies on a robust internet connection that can occassionally fail.  Also it's a bit slow, so don't run it. After all, this command is tested in the unit tests.--></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nex</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_trees.html">add_trees</a></span><span class="op">(</span><span class="va">bird.orders</span><span class="op">)</span></span>
<span><span class="va">nex</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/taxize_nexml.html">taxize_nexml</a></span><span class="op">(</span><span class="va">nex</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="working-with-character-data">Working with character data<a class="anchor" aria-label="anchor" href="#working-with-character-data"></a>
</h2>
<p>NeXML also provides a standard exchange format for handling character data. The R platform is particularly popular in the context of phylogenetic comparative methods, which consider both a given phylogeny and a set of traits. NeXML provides an ideal tool for handling this metadata.</p>
<div class="section level3">
<h3 id="extracting-character-data">Extracting character data<a class="anchor" aria-label="anchor" href="#extracting-character-data"></a>
</h3>
<p>We can load the library, parse the NeXML file and extract both the characters and the phylogeny.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/RNeXML/">RNeXML</a></span><span class="op">)</span></span>
<span><span class="va">nexml</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nexml_read.html">read.nexml</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples"</span>, <span class="st">"comp_analysis.xml"</span>, package<span class="op">=</span><span class="st">"RNeXML"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">traits</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_characters.html">get_characters</a></span><span class="op">(</span><span class="va">nexml</span><span class="op">)</span></span>
<span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_trees.html">get_trees</a></span><span class="op">(</span><span class="va">nexml</span><span class="op">)</span></span></code></pre></div>
<p>(Note that <code>get_characters</code> would return both discrete and continuous characters together in the same data.frame, but we use <code>get_characters_list</code> to get separate data.frames for the continuous <code>characters</code> block and the discrete <code>characters</code> block).</p>
<p>We can then fire up <code>geiger</code> and fit, say, a Brownian motion model the continuous data and a Markov transition matrix to the discrete states:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">geiger</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/geiger/man/fitContinuous.html" class="external-link">fitContinuous</a></span><span class="op">(</span><span class="va">tree</span>, <span class="va">traits</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, ncores<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/geiger/man/fitDiscrete.html" class="external-link">fitDiscrete</a></span><span class="op">(</span><span class="va">tree</span>, <span class="va">traits</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, ncores<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>

  

  

  </body>
</html>
