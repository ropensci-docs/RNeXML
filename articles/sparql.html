<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="RNeXML">
<title>SPARQL with RNeXML • RNeXML</title>
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="SPARQL with RNeXML">
<meta property="og:description" content="RNeXML">
<meta property="og:image" content="https://docs.ropensci.org/RNeXML/logo.svg">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
<!-- End Matomo Code -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">RNeXML</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.4.11</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/S4.html">The nexml S4 Object</a>
    <a class="dropdown-item" href="../articles/intro.html">A Brief Introduction to RNeXML</a>
    <a class="dropdown-item" href="../articles/metadata.html">Handling Metadata in RNeXML</a>
    <a class="dropdown-item" href="../articles/simmap.html">Extending NeXML: an example based on simmap</a>
    <a class="dropdown-item" href="../articles/sparql.html">SPARQL with RNeXML</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/RNeXML/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>SPARQL with RNeXML</h1>
                        <h4 data-toc-skip class="author">Carl Boettiger</h4>
                        <h4 data-toc-skip class="author">Scott Chamberlain</h4>
                        <h4 data-toc-skip class="author">Rutger Vos</h4>
                        <h4 data-toc-skip class="author">Hilmar Lapp</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/RNeXML/blob/HEAD/vignettes/sparql.Rmd" class="external-link"><code>vignettes/sparql.Rmd</code></a></small>
      <div class="d-none name"><code>sparql.Rmd</code></div>
    </div>

    
    
<!--
%\VignetteEngine{knitr::rmarkdown}
%\VignetteIndexEntry{SPARQL with RNeXML}
-->
<div class="section level2">
<h2 id="sparql-queries">SPARQL Queries<a class="anchor" aria-label="anchor" href="#sparql-queries"></a>
</h2>
<p>Rich, semantically meaningful metadata lies at the heart of the NeXML standard. R provides a rich environment to unlock this information. While our previous examples have relied on the user knowing exactly what metadata they intend to extract (title, publication date, citation information, and so forth), <em>semantic</em> metadata has meaning that a computer can make use of, allowing us to make much more conceptually rich queries than those simple examples. The SPARQL query language is a powerful way to make use of such semantic information in making complex queries.</p>
<p>While users should consult a formal introduction to SPARQL for further background, here we illustrate how SPARQL can be used in combination with R functions in ways that would be much more tedious to assemble with only traditional/non-semantic queries. The SPARQL query language is provided for the R environment through the <code>rrdf</code> package <span class="citation">[@Willighagen_2014]</span>, so we start by loading that package. We will also make use of functions from <code>phytools</code> and <code>RNeXML</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://docs.ropensci.org/rdflib/" class="external-link">"rdflib"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://xml2.r-lib.org/" class="external-link">"xml2"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/liamrevell/phytools" class="external-link">"phytools"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://docs.ropensci.org/RNeXML/">"RNeXML"</a></span><span class="op">)</span></span></code></pre></div>
<p>We read in an example file that contains semantic metadata annotations describing the taxonomic units (OTUs) used in the tree.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nexml</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nexml_read.html">nexml_read</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples/primates.xml"</span>, package<span class="op">=</span><span class="st">"RNeXML"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>In particular, this example declares the taxon rank, NCBI identifier and parent taxon for each OTU, such as:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode xml"><code class="sourceCode xml"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>&lt;<span class="kw">otu</span><span class="ot"> about=</span><span class="st">"#ou541"</span><span class="ot"> id=</span><span class="st">"ou541"</span><span class="ot"> label=</span><span class="st">"Alouatta guariba"</span>&gt;</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>      &lt;<span class="kw">meta</span><span class="ot"> href=</span><span class="st">"http://ncbi.nlm.nih.gov/taxonomy/182256"</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="ot">            id=</span><span class="st">"ma20"</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="ot">            rel=</span><span class="st">"concept:toTaxon"</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="ot">            xsi:type=</span><span class="st">"nex:ResourceMeta"</span>/&gt;</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>      &lt;<span class="kw">meta</span><span class="ot"> href=</span><span class="st">"http://rs.tdwg.org/ontology/voc/TaxonRank#Species"</span> </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="ot">            id=</span><span class="st">"ma21"</span> </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="ot">            rel=</span><span class="st">"concept:rank"</span> </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="ot">            xsi:type=</span><span class="st">"nex:ResourceMeta"</span>/&gt;</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>      &lt;<span class="kw">meta</span><span class="ot"> href=</span><span class="st">"http://ncbi.nlm.nih.gov/taxonomy/9499"</span> </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="ot">            id=</span><span class="st">"ma22"</span> </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="ot">            rel=</span><span class="st">"rdfs:subClassOf"</span> </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="ot">            xsi:type=</span><span class="st">"nex:ResourceMeta"</span>/&gt;</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    &lt;/<span class="kw">otu</span>&gt;</span></code></pre></div>
<p>In this example, we will construct a cladogram by using this information to identify the taxonomic rank of each OTU, and its shared parent taxonomic rank. (If this example looks complex, try writing down the steps to do this without the aid of the SPARQL queries). These examples show the manipulation of semantic triples, Unique Resource Identifiers (URIs) and use of the SPARQL “Join” operator.</p>
<p>Note that this example can be run using <code>demo("sparql", "RNeXML")</code> to see the code displayed in the R terminal and to avoid character errors that can occur in having to copy and paste from PDF files.</p>
<p>We begin by extracting the RDF graph from the NeXML,</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_rdf.html">get_rdf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples/primates.xml"</span>, package<span class="op">=</span><span class="st">"RNeXML"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span>  <span class="co"># so we must write the XML out first</span></span>
<span><span class="fu">xml2</span><span class="fu">::</span><span class="fu"><a href="http://xml2.r-lib.org/reference/write_xml.html" class="external-link">write_xml</a></span><span class="op">(</span><span class="va">rdf</span>, <span class="va">tmp</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/rdflib/reference/rdf_parse.html" class="external-link">rdf_parse</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span></span></code></pre></div>
<p>We then fetch the NCBI URI for the taxon that has rank ‘Order’, i.e. the root of the primates phylogeny. The dot operator <code>.</code> between clauses implies a join, in this case</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">root</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/rdflib/reference/rdf_query.html" class="external-link">rdf_query</a></span><span class="op">(</span><span class="va">graph</span>, </span>
<span><span class="st">"SELECT ?uri WHERE { </span></span>
<span><span class="st">    ?id &lt;http://rs.tdwg.org/ontology/voc/TaxonConcept#rank&gt; &lt;http://rs.tdwg.org/ontology/voc/TaxonRank#Order&gt; . </span></span>
<span><span class="st">    ?id &lt;http://rs.tdwg.org/ontology/voc/TaxonConcept#toTaxon&gt; ?uri    </span></span>
<span><span class="st">}"</span><span class="op">)</span></span></code></pre></div>
<p>This makes use of the SPARQL query language provided by the <code>rrdf</code> package. We will also define some helper functions that use SPARQL queries. Here we define a function to get the name</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">get_name</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">max</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">nexml</span><span class="op">@</span><span class="va">otus</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">otu</span><span class="op">)</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">max</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span> <span class="va">nexml</span><span class="op">@</span><span class="va">otus</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">otu</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">id</span> <span class="op">==</span> <span class="va">id</span> <span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">label</span> <span class="op">&lt;-</span> <span class="va">nexml</span><span class="op">@</span><span class="va">otus</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">otu</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">label</span></span>
<span>      <span class="va">label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">" "</span>,<span class="st">"_"</span>,<span class="va">label</span><span class="op">)</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">label</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Next, we define a recursive function to build a newick tree from the taxonomic rank information.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">recurse</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">node</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>    <span class="co"># fetch the taxonomic rank and id string</span></span>
<span>    <span class="va">rank_query</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>        <span class="st">"SELECT ?rank ?id WHERE {</span></span>
<span><span class="st">            ?id &lt;http://rs.tdwg.org/ontology/voc/TaxonConcept#toTaxon&gt; &lt;"</span>,<span class="va">node</span>,<span class="st">"&gt; .</span></span>
<span><span class="st">            ?id &lt;http://rs.tdwg.org/ontology/voc/TaxonConcept#rank&gt; ?rank</span></span>
<span><span class="st">          }"</span><span class="op">)</span></span>
<span>    <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/rdflib/reference/rdf_query.html" class="external-link">rdf_query</a></span><span class="op">(</span><span class="va">graph</span>, <span class="va">rank_query</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># get the local ID, strip URI part</span></span>
<span>    <span class="va">id</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">$</span><span class="va">id</span></span>
<span>    <span class="va">id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"^.+#"</span>, <span class="st">""</span>, <span class="va">id</span>, perl <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># if rank is terminal, return the name</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">rank</span> <span class="op">==</span> <span class="st">"http://rs.tdwg.org/ontology/voc/TaxonRank#Species"</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu">get_name</span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="co"># recurse deeper</span></span>
<span>    <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="va">child_query</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>            <span class="st">"SELECT ?uri WHERE {</span></span>
<span><span class="st">                ?id &lt;http://www.w3.org/2000/01/rdf-schema#subClassOf&gt; &lt;"</span>,<span class="va">node</span>,<span class="st">"&gt; .</span></span>
<span><span class="st">                ?id &lt;http://rs.tdwg.org/ontology/voc/TaxonConcept#toTaxon&gt; ?uri</span></span>
<span><span class="st">            }"</span><span class="op">)</span></span>
<span>        <span class="va">children</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/rdflib/reference/rdf_query.html" class="external-link">rdf_query</a></span><span class="op">(</span><span class="va">graph</span>, <span class="va">child_query</span><span class="op">)</span></span>
<span>        </span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"("</span>, </span>
<span>                     <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">children</span><span class="op">$</span><span class="va">uri</span>, <span class="va">recurse</span><span class="op">)</span>, </span>
<span>                           sep <span class="op">=</span> <span class="st">","</span>, collapse <span class="op">=</span> <span class="st">","</span> <span class="op">)</span>, </span>
<span>                     <span class="st">")"</span>,  </span>
<span>                     <span class="fu">get_name</span><span class="op">(</span><span class="va">id</span><span class="op">)</span>, <span class="co"># label interior nodes</span></span>
<span>                     sep <span class="op">=</span> <span class="st">""</span>, collapse <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>With these functions in place, it is straight forward to build the tree from the semantic RDFa data and then visualize it</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">newick</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu">recurse</span><span class="op">(</span><span class="va">root</span><span class="op">)</span>, <span class="st">";"</span>, sep <span class="op">=</span> <span class="st">""</span>, collapse <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/phytools/man/read.newick.html" class="external-link">read.newick</a></span><span class="op">(</span>text <span class="op">=</span> <span class="va">newick</span><span class="op">)</span></span>
<span><span class="va">collapsed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/collapse.singles.html" class="external-link">collapse.singles</a></span><span class="op">(</span><span class="va">tree</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">collapsed</span>, </span>
<span>     type<span class="op">=</span><span class="st">'cladogram'</span>, </span>
<span>     show.tip.label<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>     show.node.label<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>     cex<span class="op">=</span><span class="fl">0.75</span>, </span>
<span>     edge.color<span class="op">=</span><span class="st">'grey60'</span>, </span>
<span>     label.offset<span class="op">=</span><span class="op">-</span><span class="fl">9</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="sparql-unnamed-chunk-8-1.png" alt=""><p class="caption">plot of chunk unnamed-chunk-8</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>

  

  

  </body>
</html>
